<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ page.excerpt | default: site.description | strip_html | strip_newlines | truncate: 180 }}">
    <meta name="theme-color" content="#0f1115">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ '/assets/css/site.css' | relative_url }}">
    <link rel="shortcut icon" type="image/x-icon" href="{{ '/odd_mune_profile.ico' | relative_url }}">
  </head>
  <body class="page-{{ page.layout }}">
    <div class="bg-noise" aria-hidden="true"></div>
    <div class="bg-grid" aria-hidden="true"></div>
    <div class="bg-orbs" aria-hidden="true"></div>
    <header class="site-header">
      <div class="container nav-wrap">
        <a class="brand" href="{{ '/' | relative_url }}">
          <span class="brand-mark"></span>
          <span class="brand-text">{{ site.title }}</span>
        </a>
        <nav class="studio-tabs" aria-label="Primary">
          <a href="{{ '/portfolio/' | relative_url }}">Portfolio</a>
          <a href="{{ '/about/' | relative_url }}">About</a>
          <a href="{{ '/cv/' | relative_url }}">CV</a>
          <a href="{{ '/contact/' | relative_url }}">Contact</a>
        </nav>
        <button class="theme-toggle" type="button" data-theme-toggle aria-label="Toggle theme">
          <span aria-hidden="true">ðŸŒž</span>
        </button>
      </div>
    </header>

    <main class="site-main">
      {{ content }}
    </main>

    <footer class="site-footer">
      <div class="container footer-grid">
        <div>
          <div class="footer-title">{{ site.title }}</div>
          <div class="footer-subtitle">Technical Designer (Unity/C#) focused on gameplay systems.</div>
        </div>
        <div class="footer-links">
          <a href="mailto:{{ site.email }}">Email</a>
          <a href="https://github.com/{{ site.github_username }}">GitHub</a>
          <a href="https://www.linkedin.com/in/{{ site.linkedin_username }}/">LinkedIn</a>
          <a href="https://instagram.com/{{ site.instagram_username }}">Instagram</a>
        </div>
      </div>
    </footer>
    <div class="lightbox" data-lightbox aria-hidden="true">
      <div class="lightbox-backdrop" data-lightbox-close></div>
      <figure class="lightbox-figure">
        <img alt="" data-lightbox-image>
        <figcaption data-lightbox-caption></figcaption>
      </figure>
      <button class="lightbox-close" type="button" data-lightbox-close aria-label="Close image view">Close</button>
    </div>
    <script>
      const themeToggle = document.querySelector("[data-theme-toggle]");
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)");
      const savedTheme = localStorage.getItem("theme");

      const applyTheme = (theme) => {
        if (theme === "dark") {
          document.documentElement.setAttribute("data-theme", "dark");
          if (themeToggle) themeToggle.innerHTML = "<span aria-hidden=\"true\">ðŸŒ™</span>";
        } else {
          document.documentElement.setAttribute("data-theme", "light");
          if (themeToggle) themeToggle.innerHTML = "<span aria-hidden=\"true\">ðŸŒž</span>";
        }
      };

      if (savedTheme) {
        applyTheme(savedTheme);
      } else {
        applyTheme(prefersDark.matches ? "dark" : "light");
      }

      prefersDark.addEventListener("change", (event) => {
        if (!localStorage.getItem("theme")) {
          applyTheme(event.matches ? "dark" : "light");
        }
      });

      if (themeToggle) {
        themeToggle.addEventListener("click", () => {
          const isDark = document.documentElement.getAttribute("data-theme") === "dark";
          const next = isDark ? "light" : "dark";
          localStorage.setItem("theme", next);
          applyTheme(next);
        });
      }

      const rollButton = document.querySelector("[data-roll]");
      const rollOutput = document.querySelector("[data-roll-output]");
      const tips = [
        "Shift one variable at a time, ship a new build every playtest.",
        "Every mechanic needs a tell, a test, and a fail state.",
        "If players skip the tutorial, the level still teaches.",
        "Balance for intent, then tune for mastery.",
        "When in doubt, cut friction before you cut depth."
      ];

      if (rollButton && rollOutput) {
        rollButton.addEventListener("click", () => {
          const next = tips[Math.floor(Math.random() * tips.length)];
          rollOutput.textContent = next;
          rollOutput.classList.remove("loot-flash");
          void rollOutput.offsetWidth;
          rollOutput.classList.add("loot-flash");
        });
      }

      const lightbox = document.querySelector("[data-lightbox]");
      const lightboxImage = document.querySelector("[data-lightbox-image]");
      const lightboxCaption = document.querySelector("[data-lightbox-caption]");
      const lightboxClosers = document.querySelectorAll("[data-lightbox-close]");

      const openLightbox = (img) => {
        if (!lightbox || !lightboxImage) return;
        lightboxImage.src = img.src;
        lightboxImage.alt = img.alt || "Expanded image";
        if (lightboxCaption) {
          lightboxCaption.textContent = img.alt || "";
          lightboxCaption.style.display = img.alt ? "block" : "none";
        }
        lightbox.classList.add("is-open");
        lightbox.setAttribute("aria-hidden", "false");
        document.body.classList.add("lightbox-open");
      };

      const closeLightbox = () => {
        if (!lightbox || !lightboxImage) return;
        lightbox.classList.remove("is-open");
        lightbox.setAttribute("aria-hidden", "true");
        lightboxImage.src = "";
        document.body.classList.remove("lightbox-open");
      };

      document.querySelectorAll(".prose img, .project-hero-media img, .card-image img").forEach((img) => {
        img.classList.add("click-zoom");
        img.addEventListener("click", () => openLightbox(img));
      });

      lightboxClosers.forEach((btn) => btn.addEventListener("click", closeLightbox));
      document.addEventListener("keydown", (event) => {
        if (event.key === "Escape") closeLightbox();
      });
    </script>
  </body>
</html>


